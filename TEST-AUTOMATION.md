# 검색 테스트 자동화 시스템

## 개요

검색 기능을 빠르고 효율적으로 테스트할 수 있는 자동화 도구입니다. 매번 브라우저에서 수동으로 검색하는 대신, 명령어 한 번으로 여러 검색어를 자동으로 테스트할 수 있습니다.

## 주요 기능

### ✅ 해결된 문제들
- **undefined 오류 수정**: API 응답에서 `total_created`, `total_processed` 필드 누락 문제 해결
- **포트 자동 감지**: 개발 서버가 실행 중인 포트를 자동으로 찾아 연결
- **API 요청 형식 수정**: `text`, `results_per_sentence` 필드로 올바른 요청 전송
- **테스트 결과 저장**: JSON 형태로 테스트 결과를 자동 저장 및 분석

### 🚀 성능 향상
- **빠른 테스트**: 클립 생성 없이 검색만 테스트 (평균 50-100ms)
- **배치 처리**: 여러 검색어를 순차적으로 자동 실행
- **결과 분석**: 성공률, 평균 시간, 총 결과 수 등 자동 분석

## 사용법

### 1. 빠른 검색 테스트 (추천)
```bash
npm run test:quick
```
- 5개 기본 검색어로 빠른 테스트
- 클립 생성 없이 검색만 테스트
- 약 5-10초 소요

### 2. 포괄적인 검색 테스트
```bash
npm run test:search
```
- 8개 일반 검색어로 테스트
- 클립 생성 없이 검색만 테스트
- 결과를 JSON 파일로 저장

### 3. 클립 생성 포함 테스트
```bash
npm run test:full
```
- 검색 + 클립 생성까지 전체 테스트
- 시간이 오래 걸림 (클립당 10-30초)
- 실제 운영 환경과 동일한 테스트

### 4. 배치 테스트 (고급 검색어)
```bash
npm run test:batch
```
- 복잡한 검색어로 테스트
- 클립 생성 포함
- 시스템 부하 테스트

### 5. 사용자 지정 검색어 테스트
```bash
node test-automation.js --search "your custom query"
```

## 테스트 결과 분석

### 실시간 출력
```
🧪 테스트 시작: 5개 검색어
🌐 서버: http://localhost:3000
🎬 클립 생성: 아니오
------------------------------------------------------------

[1/5] 검색 중...
🔍 검색 시작: "hello"
📊 검색 완료 (21ms): 0개 결과

============================================================
📊 테스트 결과 요약 (quick)
============================================================
🔍 총 검색 쿼리: 5개
✅ 성공: 4개
❌ 실패: 1개
📈 총 검색 결과: 6개
🎬 총 클립 생성: 0개
⏱️ 평균 검색 시간: 53ms
```

### 저장된 결과 파일
- 위치: `test-results/` 디렉토리
- 형식: `test-{type}-{timestamp}.json`
- 내용: 상세한 테스트 결과와 통계

## 성능 벤치마크

### 검색 속도
- **빠른 검색**: 평균 50-100ms
- **복잡한 검색**: 평균 100-200ms
- **DB 검색 실패**: 0ms (즉시 반환)

### 클립 생성 속도
- **썸네일**: 평균 5-15초
- **영상 클립**: 평균 10-30초
- **3단계 배치**: 전체 30-60초

## 문제 해결

### 1. 서버를 찾을 수 없음
```
❌ 개발 서버를 찾을 수 없습니다. npm run dev를 실행해주세요.
```
**해결**: 다른 터미널에서 `npm run dev` 실행

### 2. HTTP 400 오류
```
❌ HTTP 400: Bad Request
```
**원인**: 검색어가 너무 짧거나 영어가 아님
**해결**: 2단어 이상의 영어 문장 사용

### 3. 타임아웃 오류
```
❌ 오류: timeout
```
**해결**: 서버 부하가 높을 때 발생, 잠시 후 재시도

## 개발자 정보

### 파일 구조
```
theme-search/
├── quick-test.js           # 빠른 테스트 스크립트
├── test-automation.js      # 포괄적인 테스트 스크립트
├── test-results/           # 테스트 결과 저장 디렉토리
└── package.json           # npm 스크립트 정의
```

### 테스트 검색어 모음
- **quick**: 자주 사용되는 기본 표현
- **normal**: 일반적인 영어 문장
- **batch**: 복잡하고 고급 표현

### 확장 방법
1. `TEST_QUERIES` 객체에 새로운 검색어 그룹 추가
2. `package.json`에 새로운 npm 스크립트 추가
3. 명령행 인수로 사용자 정의 옵션 추가

## 예상 결과

### 성공적인 테스트
```
📊 테스트 결과 요약 (quick)
🔍 총 검색 쿼리: 5개
✅ 성공: 4개 (80% 성공률)
📈 총 검색 결과: 6개
⏱️ 평균 검색 시간: 53ms
```

### 시간 절약 효과
- **수동 테스트**: 5개 검색어 × 30초 = 2.5분
- **자동 테스트**: 전체 10초 = **15배 빠름**
- **클립 생성 포함**: 수동 10분 → 자동 1분 = **10배 빠름**

이제 매번 브라우저에서 수동으로 테스트할 필요 없이, 명령어 한 번으로 빠르고 정확한 테스트가 가능합니다! 🚀 